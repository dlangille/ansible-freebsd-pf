---
# defaults for freebsd-pf

pf_debug: False
pf_enable: False
pf_blacklistd_enable: False
pf_fail2ban_enable: False
pf_sshguard_enable: False
pflog_enable: True
pf_backup_conf: no

# Type of the template to create pf_rules
pf_type: "server"

# Configure pf_rules and do not notify handler to reload
pfconf_only: False

# packages
freebsd_install_method: "packages"
#freebsd_install_method: "ports"
freebsd_use_packages: "yes"
pf_fail2ban_packages:
  - security/py-fail2ban
pf_sshguard_packages:
  - security/sshguard

# rc.conf
pf_rules: "/etc/pf.conf"
pf_flags: ""
pflog_logfile: "/var/log/pflog"
pflog_flags: ""

# pf.conf
pf_ext_if: "{{ ansible_default_ipv4.device }}"
pf_wifi_if: "ath0"
pf_lan_if: "fxp1"
pf_pubserv: "22, 443" 
pf_lanserv: "22, 53, 67, 80, 443" 
pf_samba_ports: "137, 138, 139"
pf_lan_net: "10.1.0.0/24, 10.1.1.0/24"
# hosts granted acces to samba (cifs/smb) shares
pf_smb_net: "10.1.0.0/27, 10.1.1.0/27, 10.1.0.90, 10.1.1.90"
pf_reserved_internal_net: "10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 255.255.255.255/32"
pf_rules_custom: []

# sshguard
pf_ssh_whitelist: []

# blacklistd
pf_blacklistd_flags: "-r"
pf_blacklistd_conf_remote: []
pf_blacklistd_conf_local:
  - { adr: "ssh", type: "stream", proto: "*", owner: "*", name: "*", nfail: "3", disable: "24h" }
  - { adr: "ftp", type: "stream", proto: "*", owner: "*", name: "*", nfail: "3", disable: "24h" }
  - { adr: "smtp", type: "stream", proto: "*", owner: "*", name: "*", nfail: "3", disable: "24h" }
  - { adr: "submission", type: "stream", proto: "*", owner: "*", name: "*", nfail: "3", disable: "24h" }
  - { adr: "*", type: "*", proto: "*", owner: "*", name: "*", nfail: "3", disable: "60" }

# fail2ban
pf_fail2ban_flags: ""
pf_fail2ban_local_template: "default-fail2ban.local.j2"
pf_fail2ban_local_conf:
  - { section: "definition", line: "loglevel = INFO" }
pf_fail2ban_jail_local_template: "default-jail.local.j2"
pf_fail2ban_jail_local_conf:
  - { section: "default", line: "banaction = pf[actiontype=<allports>]" }
  - { section: "default", line: "banaction = pf[actiontype=<multiport>]" }

# EOF
...
